import{a as p,L as q}from"./index-Cyx9wH0p.js";import{N as L}from"./NotificationModal-BRD1dcli.js";import{d as M,e as s,m as P,o as m,c as v,a as l,b as i,w as b,u as V,q as N,r as F,F as E,s as R,t as B}from"./index-ZwJaeH-t.js";const S={class:"w-full max-w-md mx-auto mt-10"},$=["value"],_=M({__name:"RegistrarCitaMedicoPage",setup(U){const g=N(),y=Number(g.query.id),r=s(""),u=s("success"),w=s([]),f=s([]);s(""),s([]);const d=s(!1),c=s(!1),o=s({fecha:"",hora:"",id_paciente:0,id_medico:y}),x=a=>{const e=a.target.value,n=new Date(e),t=new Date;t.setDate(t.getDate()),n<=t&&(alert("La fecha seleccionada debe ser al menos un día después de la fecha actual."),o.value.fecha=""),o.value.fecha=e},h=a=>a.length===5?`${a}:00`:a,C=async()=>{try{const a=await p.get("http://localhost:8080/Medico/ListadoMedico");w.value=a.data}catch(a){console.error("Error al obtener los médicos:",a)}},D=async()=>{try{const a=await p.get("http://localhost:8080/Paciente/ListadoPaciente");f.value=a.data}catch(a){console.error("Error al obtener los pacientes:",a)}},k=async()=>{c.value=!0;const a={...o.value,hora:h(o.value.hora)};console.log(a);try{(await p.post("http://localhost:8080/Cita/RegistrarCita",a)).status===200&&(r.value="Cita registrada exitosamente.",u.value="success",o.value={fecha:"",hora:"",id_paciente:0,id_medico:0})}catch(e){e.response?e.response.data&&e.response.data.message?r.value=e.response.data:r.value=`Error: ${e.response.data} ${e.response.statusText}`:e.request?r.value="No se recibió respuesta del servidor. Por favor, intente nuevamente más tarde.":r.value="Error al configurar la petición. Por favor, intente nuevamente.",u.value="error"}finally{d.value=!0,c.value=!1}};return P(()=>{D(),C()}),(a,e)=>{const n=F("FormKit");return m(),v("div",S,[e[10]||(e[10]=l("h2",{class:"text-2xl font-bold mb-4"},"Registrar Cita Médica",-1)),i(L,{message:r.value,type:u.value,visible:d.value,"onUpdate:visible":e[0]||(e[0]=t=>d.value=!1)},null,8,["message","type","visible"]),i(n,{type:"form",onSubmit:k,class:"space-y-4",actions:!1},{default:b(()=>[i(n,{type:"date",name:"fecha",label:"Fecha",onBlur:x,"input-class":"mt-1 block w-full p-2 border border-gray-300 rounded-md text-black",validation:"required","validation-messages":{required:"La fecha es obligatoria."}}),e[4]||(e[4]=l("br",null,null,-1)),i(n,{type:"time",name:"hora",label:"Hora de la Cita",modelValue:o.value.hora,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.hora=t),"input-class":"mt-1 block w-full p-2 border border-gray-300 rounded-md text-black",validation:"required","validation-messages":{required:"La hora es obligatoria."}},null,8,["modelValue"]),e[5]||(e[5]=l("br",null,null,-1)),i(n,{type:"select",name:"paciente",label:"Paciente",modelValue:o.value.id_paciente,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.id_paciente=t),"input-class":"mt-1 block w-full p-2 border border-gray-300 rounded-md text-black",validation:"required","validation-messages":{required:"Seleccione un paciente."}},{default:b(()=>[e[3]||(e[3]=l("option",{disabled:"",value:"0"},"Seleccione un paciente",-1)),(m(!0),v(E,null,R(f.value,t=>(m(),v("option",{key:t.id_paciente,value:t.id_paciente},B(t.nombrePaciente),9,$))),128))]),_:1},8,["modelValue"]),e[6]||(e[6]=l("br",null,null,-1)),e[7]||(e[7]=l("div",{class:"space-y-4"},null,-1)),e[8]||(e[8]=l("br",null,null,-1)),e[9]||(e[9]=l("button",{type:"submit",class:"w-full py-3 px-6 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition duration-300"}," Registrar Cita Médica ",-1))]),_:1}),i(V(q),{active:c.value,"can-cancel":!0,"is-full-page":!0},null,8,["active"])])}}});export{_ as default};

import{a as p,L as E}from"./index-Cyx9wH0p.js";import{e as P}from"./Especialidades-Cb2kmacW.js";import{N as S}from"./NotificationModal-BRD1dcli.js";import{d as F,e as s,m as N,o as n,c as d,a as o,b as r,w as m,u as M,r as U,F as x,s as w,t as v}from"./index-ZwJaeH-t.js";const R={class:"w-full max-w-md mx-auto mt-10"},$=["value"],B={class:"space-y-4"},A={class:"flex space-x-4"},H=["value"],I=["value"],G=F({__name:"RegistrarCitaAdministradorPage",setup(K){const u=s(""),b=s("success"),h=s([]),k=s([]),c=s(""),f=s([]),g=s(!1),y=s(!1),l=s({fecha:"",hora:"",id_paciente:0,id_medico:0}),V=t=>{const e=t.target.value,i=new Date(e),a=new Date;a.setDate(a.getDate()),i<=a&&(alert("La fecha seleccionada debe ser al menos un día después de la fecha actual."),l.value.fecha=""),l.value.fecha=e},C=t=>t.length===5?`${t}:00`:t,q=async()=>{if(c.value)try{const t=encodeURIComponent(c.value),e=await p.get(`http://localhost:8080/Medico/ListadoMedico/Especialidad/${t}`);f.value=e.data}catch(t){console.error("Error al obtener médicos por especialidad:",t)}else f.value=h.value},L=async()=>{try{const t=await p.get("http://localhost:8080/Medico/ListadoMedico");h.value=t.data}catch(t){console.error("Error al obtener los médicos:",t)}},D=async()=>{try{const t=await p.get("http://localhost:8080/Paciente/ListadoPaciente");k.value=t.data}catch(t){console.error("Error al obtener los pacientes:",t)}},_=async()=>{y.value=!0;const t={...l.value,hora:C(l.value.hora)};console.log(t);try{(await p.post("http://localhost:8080/Cita/RegistrarCita",t)).status===200&&(u.value="Cita registrada exitosamente.",b.value="success",l.value={fecha:"",hora:"",id_paciente:0,id_medico:0})}catch(e){e.response?e.response.data&&e.response.data.message?u.value=e.response.data:u.value=`Error: ${e.response.data} ${e.response.statusText}`:e.request?u.value="No se recibió respuesta del servidor. Por favor, intente nuevamente más tarde.":u.value="Error al configurar la petición. Por favor, intente nuevamente.",b.value="error"}finally{g.value=!0,y.value=!1}};return N(()=>{D(),L()}),(t,e)=>{const i=U("FormKit");return n(),d("div",R,[e[13]||(e[13]=o("h2",{class:"text-2xl font-bold mb-4"},"Registrar Cita Médica",-1)),r(S,{message:u.value,type:b.value,visible:g.value,"onUpdate:visible":e[0]||(e[0]=a=>g.value=!1)},null,8,["message","type","visible"]),r(i,{type:"form",onSubmit:_,class:"space-y-4",actions:!1},{default:m(()=>[r(i,{type:"date",name:"fecha",label:"Fecha",onBlur:V,"input-class":"mt-1 block w-full p-2 border border-gray-300 rounded-md text-black",validation:"required","validation-messages":{required:"La fecha es obligatoria."}}),e[8]||(e[8]=o("br",null,null,-1)),r(i,{type:"time",name:"hora",label:"Hora de la Cita",modelValue:l.value.hora,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.hora=a),"input-class":"mt-1 block w-full p-2 border border-gray-300 rounded-md text-black",validation:"required","validation-messages":{required:"La hora es obligatoria."}},null,8,["modelValue"]),e[9]||(e[9]=o("br",null,null,-1)),r(i,{type:"select",name:"paciente",label:"Paciente",modelValue:l.value.id_paciente,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.id_paciente=a),"input-class":"mt-1 block w-full p-2 border border-gray-300 rounded-md text-black",validation:"required","validation-messages":{required:"Seleccione un paciente."}},{default:m(()=>[e[5]||(e[5]=o("option",{disabled:"",value:"0"},"Seleccione un paciente",-1)),(n(!0),d(x,null,w(k.value,a=>(n(),d("option",{key:a.id_paciente,value:a.id_paciente},v(a.nombrePaciente),9,$))),128))]),_:1},8,["modelValue"]),e[10]||(e[10]=o("br",null,null,-1)),o("div",B,[o("div",A,[r(i,{type:"select",name:"especialidad",label:"Especialidad",modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=a=>c.value=a),"input-class":"mt-1 block w-full p-2 border border-gray-300 rounded-md text-black",validation:"required","input-error-class":"border-red-500","validation-messages":{required:"La especialidad es obligatoria."}},{default:m(()=>[e[6]||(e[6]=o("option",{disabled:"",value:""},"Seleccione una especialidad",-1)),(n(!0),d(x,null,w(M(P),a=>(n(),d("option",{value:a},v(a),9,H))),256))]),_:1},8,["modelValue"]),o("button",{type:"button",onClick:q,class:"w-20 py-2 px-4 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition duration-300"}," Filtrar ")]),r(i,{type:"select",name:"medico",label:"Médico",modelValue:l.value.id_medico,"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.id_medico=a),"input-class":"mt-1 block w-full p-2 border border-gray-300 rounded-md text-black",validation:"required","validation-messages":{required:"Seleccione un médico."}},{default:m(()=>[e[7]||(e[7]=o("option",{disabled:"",value:"0"},"Seleccione un médico",-1)),(n(!0),d(x,null,w(f.value,a=>(n(),d("option",{key:a.id_medico,value:a.id_medico},v(a.nombreMedico)+" "+v(a.apellidoMedico),9,I))),128))]),_:1},8,["modelValue"])]),e[11]||(e[11]=o("br",null,null,-1)),e[12]||(e[12]=o("button",{type:"submit",class:"w-full py-3 px-6 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition duration-300"}," Registrar Cita Médica ",-1))]),_:1}),r(M(E),{active:y.value,"can-cancel":!0,"is-full-page":!0},null,8,["active"])])}}});export{G as default};
